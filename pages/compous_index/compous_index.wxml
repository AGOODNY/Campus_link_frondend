<!-- pages/compous_index/compous_index.wxml -->

<!-- Tabæ  -->
<view class="tab-bar">
  <view class="tab-list">
    <view 
      wx:for="{{tabs}}" 
      wx:key="id" 
      wx:for-index="index"  
      class="tab-item {{currentTab === index ? 'active' : ''}}"
      data-index="{{index}}" 
      bindtap="switchTab"
    >
      <text class="tab-text">{{item.name}}</text>
      <!-- æ·»åŠ è“çº¿æŒ‡ç¤ºå™¨ -->
      <view class="tab-indicator" wx:if="{{currentTab === index}}"></view>
    </view>
  </view>
</view>

<!-- é¡µé¢å†…å®¹ -->
<view class="page-content" style="padding-top: {{contentPadding}}px;">
  
  <!-- æœç´¢æ¡† -->
  <view class="search-container">
  <view class="search-box">
    <image src="/pages/compous_index/compous_image/search.png" class="search-icon" />
    <input 
      placeholder="Search..." 
      class="search-input"
      bindinput="onSearchInput"
      confirm-type="search"
      bindconfirm="goSearch"
    />
  </view>
</view>

  <!-- è½®æ’­å›¾ -->
  <swiper class="custom-swiper"
          indicator-dots="{{indicatorDots}}"
          autoplay="{{autoplay}}"
          interval="{{interval}}"
          duration="{{duration}}"
          circular="{{circular}}"
          bindchange="onSwiperChange">
    <swiper-item wx:for="{{swiperList}}" wx:key="id">
      <image src="{{item.imageUrl}}" class="swiper-image" 
             data-index="{{index}}" bindtap="onSwiperTap" mode="aspectFill" />
      <view class="swiper-text-overlay">
        <text class="swiper-title">{{item.title}}</text>
        <text class="swiper-desc">{{item.desc}}</text>
      </view>
    </swiper-item>
  </swiper>
  
  <!-- æŽ¨èåŒºåŸŸ -->
  <view class="recommendation-container">
  <view class="recommendation-wrapper" bindtap="toggleSortMenu">
    <image 
      src="/pages/compous_index/compous_image/sort.png" 
      class="recommend-icon" 
    />
    <text class="recommend-text">Recommendation</text>
  </view>

  
  <!-- ä¸‹æ‹‰èœå• -->
<view class="sort-menu" wx:if="{{showSortMenu}}">
  <view 
    class="sort-item {{sortType === 'hot' ? 'active' : ''}}"
    bindtap="selectSort"
    data-type="hot"
  >
    hot
  </view>
  <view 
    class="sort-item {{sortType === 'time' ? 'active' : ''}}"
    bindtap="selectSort"
    data-type="new"
  >
    post-time
  </view>
</view>

</view>
  
  <!-- ç€‘å¸ƒæµå¸–å­ -->
  <view class="waterfall-wrapper">
    <!-- å·¦åˆ— -->
    <view class="waterfall-column left">
      <view class="post-item" 
            wx:for="{{leftColumn}}" 
            wx:key="id"
            data-id="{{item.id}}"
            bindtap="onPostTap">
        <view class="post-image-wrapper">
          <image class="post-image" 
                 src="{{item.images[0]}}" 
                 mode="aspectFill" 
                 lazy-load="{{true}}" />
        </view>
        <view class="post-info">
          <text class="post-title">{{item.title}}</text>
          <text class="post-desc">{{item.desc}}</text>
          <view class="user-info">
            <image class="user-avatar" src="{{item.user.avatar}}" />
            <text class="user-name">{{item.user.name}}</text>
            <text class="post-time">{{item.time}}</text>
          </view>
          <view class="post-stats">
            <text class="stat-item">â™¥ {{item.likes}}</text>
            <text class="stat-item">ðŸ’¬ {{item.comments}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- å³åˆ— -->
<view class="waterfall-column right">
  <view class="post-item" 
        wx:for="{{rightColumn}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="onPostTap">

    <view class="post-image-wrapper">
      <image class="post-image" 
             src="{{item.images[0]}}" 
             mode="aspectFill" 
             lazy-load="{{true}}" />
    </view>

    <view class="post-info">
      <text class="post-title">{{item.title}}</text>
      <text class="post-desc">{{item.desc}}</text>

      <view class="user-info">
        <image class="user-avatar" src="{{item.user.avatar}}" />
        <text class="user-name">{{item.user.name}}</text>
        <text class="post-time">{{item.time}}</text>
      </view>

      <view class="post-stats">
        <text class="stat-item">â™¥ {{item.likes}}</text>
        <text class="stat-item">ðŸ’¬ {{item.comments}}</text>
      </view>
    </view>

  </view>
</view>
  </view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>Loading...</text>
  </view>
  
  <view wx:if="{{!hasMore && postList.length > 0}}" class="no-more">
    <text>-The end-</text>
  </view>
</view>