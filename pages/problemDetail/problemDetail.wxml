<!-- pages/problemDetail/problemDetail.wxml -->
<view class="page">
  <!-- 问题主体 -->
  <view class="card">
    <view class="header">
      <view class="user">
        <image class="avatar" src="{{question.avatar}}" />
        <text class="nickname">{{question.nickname}}</text>
      </view>

      <!--状态显示：pending / accepted / resolved -->
      <text class="status {{question.status}}">
        {{ statusMap[question.status] }}
      </text>
    </view>

    <view class="content">
      {{question.content}}
    </view>

    <!-- 图片展示 -->
    <view wx:if="{{question.images && question.images.length}}" class="img-list">
      <image
        wx:for="{{question.images}}"
        wx:key="*"
        src="{{item}}"
        mode="aspectFill"
        bindtap="previewImage"
        data-src="{{item}}"
      />
    </view>

    <view class="time">
      Question Time：{{question.createTime}}
    </view>
  </view>

  <!-- Processing Progress -->
  <view class="section-title">Processing Progress</view>

  <view class="card">
    <block wx:for="{{replies}}" wx:key="id">
      <view class="reply-item">
        <view class="reply-header">
          <text class="reply-name">{{item.staffName}}</text>
          <text class="reply-time">{{item.time}}</text>
        </view>
        <view class="reply-content">{{item.content}}</view>
      </view>
    </block>

    <view wx:if="{{!replies.length}}" class="empty">
      No reply yet
    </view>
  </view>

  <!-- 教职工回复输入 -->
  <form
    wx:if="{{isStaff && question.status !== 'resolved'}}"
    bindsubmit="submitReply"
    class="reply-form"
  >
    <textarea
      name="reply"
      placeholder="Please enter a reply"
    />
    <button formType="submit" class="reply-btn">Submit Reply</button>
  </form>


</view>
